/**
 * Vulnerability Trend Chart
 * Displays vulnerability trends over time using a line chart
 */

import { Typography, Paper, useTheme } from '@mui/material';
import {
  LineChart,
  Line,
  XAxis,
  YAxis,
  CartesianGrid,
  Tooltip,
  Legend,
  ResponsiveContainer,
} from 'recharts';

interface DataPoint {
  date: string;
  critical: number;
  high: number;
  medium: number;
  low: number;
}

interface VulnerabilityTrendChartProps {
  data?: DataPoint[];
  title?: string;
  height?: number;
}

// Default mock data for demonstration
const defaultData: DataPoint[] = [
  { date: 'Mon', critical: 2, high: 4, medium: 8, low: 12 },
  { date: 'Tue', critical: 3, high: 5, medium: 10, low: 15 },
  { date: 'Wed', critical: 1, high: 6, medium: 12, low: 18 },
  { date: 'Thu', critical: 4, high: 8, medium: 9, low: 14 },
  { date: 'Fri', critical: 2, high: 7, medium: 11, low: 16 },
  { date: 'Sat', critical: 1, high: 3, medium: 6, low: 10 },
  { date: 'Sun', critical: 0, high: 2, medium: 5, low: 8 },
];

const VulnerabilityTrendChart = ({
  data = defaultData,
  title = 'Vulnerability Trends',
  height = 300,
}: VulnerabilityTrendChartProps) => {
  const theme = useTheme();

  const colors = {
    critical: '#b71c1c',
    high: '#ff5252',
    medium: '#ff9800',
    low: '#ffeb3b',
  };

  return (
    <Paper sx={{ p: 2, height: height + 60 }}>
      <Typography variant="h6" sx={{ mb: 2, fontWeight: 600 }}>
        ðŸ“ˆ {title}
      </Typography>
      <ResponsiveContainer width="100%" height={height}>
        <LineChart data={data}>
          <CartesianGrid strokeDasharray="3 3" stroke={theme.palette.divider} />
          <XAxis
            dataKey="date"
            stroke={theme.palette.text.secondary}
            tick={{ fill: theme.palette.text.secondary }}
          />
          <YAxis
            stroke={theme.palette.text.secondary}
            tick={{ fill: theme.palette.text.secondary }}
          />
          <Tooltip
            contentStyle={{
              backgroundColor: theme.palette.background.paper,
              border: `1px solid ${theme.palette.divider}`,
              borderRadius: 8,
            }}
            labelStyle={{ color: theme.palette.text.primary }}
          />
          <Legend />
          <Line
            type="monotone"
            dataKey="critical"
            name="Critical"
            stroke={colors.critical}
            strokeWidth={2}
            dot={{ r: 4 }}
            activeDot={{ r: 6 }}
          />
          <Line
            type="monotone"
            dataKey="high"
            name="High"
            stroke={colors.high}
            strokeWidth={2}
            dot={{ r: 4 }}
            activeDot={{ r: 6 }}
          />
          <Line
            type="monotone"
            dataKey="medium"
            name="Medium"
            stroke={colors.medium}
            strokeWidth={2}
            dot={{ r: 4 }}
            activeDot={{ r: 6 }}
          />
          <Line
            type="monotone"
            dataKey="low"
            name="Low"
            stroke={colors.low}
            strokeWidth={2}
            dot={{ r: 4 }}
            activeDot={{ r: 6 }}
          />
        </LineChart>
      </ResponsiveContainer>
    </Paper>
  );
};

export default VulnerabilityTrendChart;
